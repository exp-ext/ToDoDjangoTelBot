{% extends "base.html" %}
{% load static %}

{% block head %}
  <meta name="description" content="Организуйте свои заметки с помощью простого и эффектовного инструмента - YourToDo!"/>
  <meta name="keywords" content="заметки, сделать личный блог, телеграмм, лучшие телеграмм каналы, канал продвижение">
  <meta name="robots" content="index, follow">
  <meta name="author" content="Your To-Do">
  <link rel="stylesheet" href="{% static 'css/moving_units.css' %}">
  <link rel="stylesheet" href="{% static 'css/hover-effects.css' %}">
  <link rel="stylesheet" href="{% static 'css/search.css' %}">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
{% endblock %}

{% block title %}Публикации{% endblock %}

{% block content %}

  <div class="container py-5">

    {% include 'posts/includes/switcher.html' %}

    <div class="moving-unit _anim-items _anim-no-hide">
      {% include 'posts/includes/search.html' %}
    </div> 

    <div class="ck ck-content">
      {% for post in page_obj %} 
        {% include 'posts/includes/post_list.html' %}        
      {% endfor %} 
    </div> 

    {% include 'posts/includes/paginator.html' %}
  </div> 

  {% if is_mobile %}
    {% include 'includes/yamobileflooradvertising.html' %}
  {% else %}
      {% include 'includes/yapcflooradvertising.html' %}
  {% endif %}

{% endblock %}

{% block javascript %}
  <script  src="{% static 'js/script.js' %}"></script>
  <script>
    $(document).ready(function() {
      $("#search-input").autocomplete({
        source: "{% url 'posts:search' %}",
        minLength: 2,
        focus: function(event, ui) {
          $("#search-input").val(ui.item.label); // Устанавливаем текст в поле ввода при фокусировке
          return false;
        },
        select: function(event, ui) {
          if (ui.item.link) {
            window.location.href = ui.item.link; // Перенаправляем на страницу, связанную с выбранным элементом
          } else {
            $("#search-input").val(ui.item.label); // Вставляем текст в поле ввода
          }
          return false;
        },
      }).data("ui-autocomplete")._renderItem = function(ul, item) {
        var listItem = $("<li>");
        listItem.addClass("ui-menu-item");
        if (item.link) {
          listItem.append("<img src='" + item.image + "' height='30'/>" + "<a href='" + item.link + "'>" + item.label + " </a>");
        } else {
          listItem.append("<div>" + item.label + "</div>");
        }
        return listItem.appendTo(ul);
      };
    });
  </script>
{% endblock %}
